{"ast":null,"code":"import _slicedToArray from \"C:\\\\Users\\\\xavie\\\\bootcamp\\\\collab\\\\skylab-bootcamp-201909\\\\staff\\\\javier-sevilla\\\\skillpop\\\\skillpop-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\xavie\\\\bootcamp\\\\collab\\\\skylab-bootcamp-201909\\\\staff\\\\javier-sevilla\\\\skillpop\\\\skillpop-app\\\\src\\\\components\\\\App\\\\index.js\";\nimport React, { useState, useEffect } from 'react';\nimport './index.sass';\nimport Register from '../Register';\nimport Header from '../Header';\nimport Login from '../Login';\nimport Landing from '../Landing';\nimport Detail from '../Detail';\nimport Profile from '../Profile';\nimport ModifyAd from '../ModifyAd';\nimport CreateAd from '../CreateAd';\nimport PublicProfile from '../PublicProfile';\nimport { Route, withRouter, Redirect } from 'react-router-dom';\nimport { authenticateUser, registerUser, retrieveUser, searchAds, retrieveAd, retrievePublicUser, retrieveAds, removeAd, modifyAd, saveImageAd, modifyUser, saveImageProfile, createAd, retrievePublicAds } from '../../logic';\nimport queryString from 'query-string';\nexport default withRouter(function ({\n  history\n}) {\n  const _useState = useState([]),\n        _useState2 = _slicedToArray(_useState, 2),\n        ads = _useState2[0],\n        setAds = _useState2[1];\n\n  const _useState3 = useState([]),\n        _useState4 = _slicedToArray(_useState3, 2),\n        adId = _useState4[0],\n        setAdId = _useState4[1];\n\n  const _useState5 = useState([]),\n        _useState6 = _slicedToArray(_useState5, 2),\n        ad = _useState6[0],\n        setAd = _useState6[1];\n\n  const _useState7 = useState([]),\n        _useState8 = _slicedToArray(_useState7, 2),\n        user = _useState8[0],\n        setUser = _useState8[1]; // const [name, setName] = useState()\n  // const [tasks, setTasks] = useState([])\n\n\n  useEffect(() => {\n    const _sessionStorage = sessionStorage,\n          token = _sessionStorage.token; // (async () => {\n    //     if (token) {\n    //         const { name } = await retrieveUser(token)\n    //         setName(name)\n    //         await retrieveTasks(token)\n    //     }\n    // })()\n  }, [sessionStorage.token]);\n\n  function handleGoBack(webant) {\n    history.push(`/${webant}`);\n  }\n\n  function handleLogout() {\n    sessionStorage.clear();\n    const webant = \"login\";\n    handleGoBack(webant);\n  }\n\n  function handleGoToRegister() {\n    history.push('/register');\n  }\n\n  function handleGoToLogin() {\n    history.push('/login');\n  }\n\n  async function handleRegister(name, surname, city, address, email, password) {\n    try {\n      await registerUser(name, surname, city, address, email, password);\n      history.push('/login');\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  async function handleLogin(email, password) {\n    try {\n      const token = await authenticateUser(email, password);\n      console.log(token);\n      sessionStorage.token = token;\n      history.push('/');\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  async function handleSearch(query) {\n    try {\n      const ads = await searchAds(query);\n      setAds(ads);\n      history.push(\"/\");\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  async function handleAdDetail(adId) {\n    try {\n      const ad = await retrieveAd(adId);\n\n      const _ref = await retrievePublicUser(ad.user),\n            name = _ref.name;\n\n      ad.name = name;\n      setAdId(adId);\n      setAd(ad);\n      history.push(`/ad/${adId}`);\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  async function handleProfile() {\n    try {\n      const token = sessionStorage.token;\n      const user = await retrieveUser(token);\n      const ads = await retrieveAds(token);\n      setAds(ads);\n      setUser(user);\n      history.push(\"/profile\");\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  async function handleDeleteAd(adId) {\n    try {\n      const token = sessionStorage.token;\n      await removeAd(token, adId);\n      const ads = await retrieveAds(token);\n      setAds(ads);\n      history.push(\"/profile\");\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  async function handleToUpdateAd(adId) {\n    try {\n      const token = sessionStorage.token;\n      const ad = await retrieveAd(adId);\n      setAd(ad);\n      setAdId(adId); // history.push(\"/update\")    \n\n      history.push(`/update/${adId}`);\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  async function handleOnUpdateAd(image, adId, title, description, price) {\n    try {\n      const token = sessionStorage.token;\n      const priceN = Number.parseInt(price);\n      await modifyAd(token, adId, title, description, priceN);\n\n      if (image) {\n        await saveImageAd(token, adId, image);\n      }\n\n      const ad = await retrieveAd(adId);\n      setAd(ad);\n      setAdId(adId);\n      history.push(\"/profile\"); // history.push(`/update/${adId}`)\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  async function handleUpdateUser(image, name, surname, city, address) {\n    try {\n      const token = sessionStorage.token;\n      await modifyUser(token, name, surname, city, address);\n\n      if (image) {\n        await saveImageProfile(token, image);\n      }\n\n      const user = await retrieveUser(token);\n      setUser(user);\n      history.push(\"/profile\");\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  async function handleToCreateAd() {\n    history.push(\"/newad\");\n  }\n\n  async function handleCreateAd(image, title, price, description) {\n    try {\n      const token = sessionStorage.token;\n      const priceN = Number.parseInt(price);\n      const adId = await createAd(token, title, description, priceN);\n\n      if (image) {\n        await saveImageAd(token, adId, image);\n      }\n\n      const user = await retrieveUser(token);\n      const ad = await retrieveAd(adId);\n      setAd(ad);\n      setUser(user);\n      history.push(`/ad/${adId}`);\n    } catch (error) {\n      console.error(error);\n    }\n  } // ESTOY AQUI\n\n\n  async function handleToPubliProfile(id) {\n    let token = \"\";\n    let user = \"\";\n    let ads = [];\n\n    if (!id) {\n      token = sessionStorage.token;\n      user = await retrieveUser(token);\n      id = user.id;\n      ads = await retrieveAds(token);\n      console.log(ads);\n    } else {\n      user = await retrievePublicUser(id);\n      id = user.id;\n      ads = await retrievePublicAds(id);\n    }\n\n    setAds(ads);\n    setUser(user);\n    history.push(`/publicprofile/${id}`);\n  }\n\n  const _sessionStorage2 = sessionStorage,\n        token = _sessionStorage2.token;\n  return React.createElement(React.Fragment, null, React.createElement(Route, {\n    exact: true,\n    path: \"/\",\n    render: () => React.createElement(React.Fragment, null, React.createElement(Landing, {\n      onSearch: handleSearch,\n      onLogin: handleGoToLogin,\n      onRegister: handleGoToRegister,\n      onLogout: handleLogout,\n      ads: ads,\n      adDetail: handleAdDetail,\n      onProfile: handleProfile,\n      onToCreateAd: handleToCreateAd,\n      onToPubliProfile: handleToPubliProfile,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 285\n      },\n      __self: this\n    })),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 285\n    },\n    __self: this\n  }), React.createElement(Route, {\n    path: \"/register\",\n    render: () => React.createElement(React.Fragment, null, React.createElement(Header, {\n      onBack: handleGoBack,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287\n      },\n      __self: this\n    }), \"  \", React.createElement(Register, {\n      onRegister: handleRegister,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287\n      },\n      __self: this\n    })),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 287\n    },\n    __self: this\n  }), React.createElement(Route, {\n    path: \"/login\",\n    render: () => React.createElement(React.Fragment, null, React.createElement(Header, {\n      onBack: handleGoBack,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288\n      },\n      __self: this\n    }), \" \", React.createElement(Login, {\n      onLogin: handleLogin,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288\n      },\n      __self: this\n    })),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 288\n    },\n    __self: this\n  }), React.createElement(Route, {\n    path: \"/ad/:adId\",\n    render: () => React.createElement(React.Fragment, null, React.createElement(Header, {\n      onBack: handleGoBack,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 289\n      },\n      __self: this\n    }), React.createElement(Detail, {\n      ad: ad,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 289\n      },\n      __self: this\n    })),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 289\n    },\n    __self: this\n  }), React.createElement(Route, {\n    path: \"/profile\",\n    render: () => React.createElement(React.Fragment, null, React.createElement(Header, {\n      onBack: handleGoBack,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 290\n      },\n      __self: this\n    }), React.createElement(Profile, {\n      ads: ads,\n      user: user,\n      adDetail: handleAdDetail,\n      onDeleteAd: handleDeleteAd,\n      onToUpdateAd: handleToUpdateAd,\n      onUpdateUser: handleUpdateUser,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 290\n      },\n      __self: this\n    })),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 290\n    },\n    __self: this\n  }), React.createElement(Route, {\n    path: \"/update/:adId\",\n    render: () => React.createElement(React.Fragment, null, React.createElement(Header, {\n      onBack: handleGoBack,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 291\n      },\n      __self: this\n    }), React.createElement(ModifyAd, {\n      ad: ad,\n      onUpdateAd: handleOnUpdateAd,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 291\n      },\n      __self: this\n    })),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 291\n    },\n    __self: this\n  }), React.createElement(Route, {\n    path: \"/newad\",\n    render: () => React.createElement(React.Fragment, null, React.createElement(Header, {\n      onBack: handleGoBack,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 292\n      },\n      __self: this\n    }), React.createElement(CreateAd, {\n      onCreateAd: handleCreateAd,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 292\n      },\n      __self: this\n    })),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 292\n    },\n    __self: this\n  }), React.createElement(Route, {\n    path: \"/publicprofile/:id\",\n    render: () => React.createElement(PublicProfile, {\n      ads: ads,\n      user: user,\n      adDetail: handleAdDetail,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293\n      },\n      __self: this\n    }),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 293\n    },\n    __self: this\n  }));\n});\n{\n  /* <Route path=\"/register\" render={() => token ? <Redirect to=\"/board\" /> : <Register onRegister={handleRegister} onBack={handleGoBack} />} />\r\n  <Route path=\"/login\" render={() => token ? <Redirect to=\"/board\" /> : <Login onLogin={handleLogin} onBack={handleGoBack} />} />\r\n  <Route path=\"/board\" render={() => token ? <Board user={name} tasks={tasks} onLogout={handleLogout} onChangeTaskStatus={handleChangeTaskStatus} onNewTask={handleNewTask} /> : <Redirect to=\"/\" />} />\r\n  <Route path=\"/hello/:name\" render={props => <Hello name={props.match.params.name} />} />\r\n  <Route path=\"/hello/:name\" render={({ match: { params: { name } } }) => <Hello name={name} />} /> */\n}","map":{"version":3,"sources":["C:/Users/xavie/bootcamp/collab/skylab-bootcamp-201909/staff/javier-sevilla/skillpop/skillpop-app/src/components/App/index.js"],"names":["React","useState","useEffect","Register","Header","Login","Landing","Detail","Profile","ModifyAd","CreateAd","PublicProfile","Route","withRouter","Redirect","authenticateUser","registerUser","retrieveUser","searchAds","retrieveAd","retrievePublicUser","retrieveAds","removeAd","modifyAd","saveImageAd","modifyUser","saveImageProfile","createAd","retrievePublicAds","queryString","history","ads","setAds","adId","setAdId","ad","setAd","user","setUser","sessionStorage","token","handleGoBack","webant","push","handleLogout","clear","handleGoToRegister","handleGoToLogin","handleRegister","name","surname","city","address","email","password","error","console","handleLogin","log","handleSearch","query","handleAdDetail","handleProfile","handleDeleteAd","handleToUpdateAd","handleOnUpdateAd","image","title","description","price","priceN","Number","parseInt","handleUpdateUser","handleToCreateAd","handleCreateAd","handleToPubliProfile","id"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport './index.sass'\r\nimport Register from '../Register'\r\nimport Header from '../Header'\r\nimport Login from '../Login'\r\nimport Landing from '../Landing'\r\nimport Detail from '../Detail'\r\nimport Profile from '../Profile'\r\nimport ModifyAd from '../ModifyAd'\r\nimport CreateAd from '../CreateAd'\r\nimport PublicProfile from '../PublicProfile'\r\nimport { Route, withRouter, Redirect } from 'react-router-dom'\r\nimport { authenticateUser, registerUser, retrieveUser, searchAds, retrieveAd, retrievePublicUser, retrieveAds, removeAd, modifyAd, saveImageAd, modifyUser, saveImageProfile, \r\n         createAd, retrievePublicAds} from '../../logic'\r\n\r\nimport queryString from 'query-string'\r\n\r\nexport default withRouter(function ({ history }) {\r\n    const [ads, setAds] = useState([])\r\n    const [adId, setAdId] = useState([])\r\n    const [ad, setAd] = useState([])\r\n    const [user, setUser] = useState([])\r\n    // const [name, setName] = useState()\r\n    // const [tasks, setTasks] = useState([])\r\n\r\n    useEffect(() => {\r\n        const { token } = sessionStorage;\r\n\r\n        // (async () => {\r\n        //     if (token) {\r\n        //         const { name } = await retrieveUser(token)\r\n\r\n        //         setName(name)\r\n\r\n        //         await retrieveTasks(token)\r\n        //     }\r\n        // })()\r\n    }, [sessionStorage.token])\r\n\r\n\r\n    function handleGoBack(webant) { \r\n\r\n        \r\n        history.push(`/${webant}`) \r\n    }\r\n\r\n    function handleLogout() {\r\n        sessionStorage.clear()\r\n        const webant = \"login\"\r\n        handleGoBack(webant)\r\n    }\r\n\r\n    function handleGoToRegister() { history.push('/register') }\r\n\r\n    function handleGoToLogin() { history.push('/login') }\r\n\r\n\r\n    async function handleRegister(name, surname, city, address, email, password) {\r\n        try {\r\n            await registerUser(name, surname, city, address, email, password)\r\n\r\n            history.push('/login')\r\n        } catch (error) {\r\n            console.error(error)\r\n        }\r\n    }\r\n\r\n    async function handleLogin(email, password) {\r\n        try {\r\n            const token = await authenticateUser(email, password)\r\n            console.log(token)\r\n            sessionStorage.token = token\r\n            \r\n\r\n            history.push('/')\r\n        } catch (error) {\r\n            console.error(error)\r\n        }\r\n    }\r\n\r\n    async function handleSearch(query) {\r\n        try {\r\n            const ads = await searchAds(query)\r\n\r\n            setAds(ads)\r\n\r\n            history.push(\"/\")\r\n\r\n        } catch (error) {\r\n            console.error(error)\r\n        }\r\n    }\r\n\r\n    async function handleAdDetail(adId) {\r\n        try {\r\n            const ad = await retrieveAd(adId)\r\n            const { name } = await retrievePublicUser(ad.user)\r\n\r\n            ad.name = name\r\n\r\n            setAdId(adId)\r\n            setAd(ad)\r\n\r\n            history.push(`/ad/${adId}`)\r\n\r\n        } catch (error) {\r\n            console.error(error)\r\n        }\r\n    }\r\n\r\n    async function handleProfile() {\r\n        try {\r\n            const token = sessionStorage.token\r\n\r\n            const user = await retrieveUser(token)\r\n\r\n            const ads = await retrieveAds(token)\r\n\r\n            setAds(ads)\r\n            setUser(user)\r\n\r\n            history.push(\"/profile\")\r\n\r\n        } catch (error) {\r\n            console.error(error)\r\n        }\r\n    }\r\n\r\n    async function handleDeleteAd(adId) {\r\n        try {\r\n            const token = sessionStorage.token\r\n\r\n            await removeAd(token, adId)\r\n\r\n            const ads = await retrieveAds(token)\r\n\r\n            setAds(ads)            \r\n\r\n            history.push(\"/profile\")\r\n\r\n        } catch (error) {\r\n            console.error(error)\r\n        }\r\n    }\r\n\r\n    async function handleToUpdateAd(adId) {\r\n\r\n         try {\r\n\r\n            const token = sessionStorage.token \r\n\r\n            const ad = await retrieveAd(adId)\r\n\r\n            setAd(ad)   \r\n            setAdId(adId)       \r\n\r\n            // history.push(\"/update\")    \r\n\r\n            history.push(`/update/${adId}`)\r\n\r\n        } catch (error) {\r\n            console.error(error)\r\n        }      \r\n    }\r\n\r\n    async function handleOnUpdateAd(image, adId, title, description, price) {\r\n\r\n         try {\r\n\r\n            const token = sessionStorage.token \r\n\r\n            const priceN = Number.parseInt(price)\r\n\r\n            await modifyAd(token, adId, title, description, priceN)\r\n\r\n            if (image) {\r\n\t\t\t\tawait saveImageAd(token, adId, image)\r\n\t\t\t}\r\n\r\n            const ad = await retrieveAd(adId)\r\n\r\n            setAd(ad)   \r\n            setAdId(adId)     \r\n\r\n            history.push(\"/profile\")    \r\n\r\n            // history.push(`/update/${adId}`)\r\n\r\n        } catch (error) {\r\n            console.error(error)\r\n        }      \r\n    }\r\n\r\n    async function handleUpdateUser(image, name, surname, city, address ) {\r\n\r\n         try {\r\n\r\n            const token = sessionStorage.token \r\n\r\n            await modifyUser(token, name, surname, city, address)\r\n\r\n            if (image) {\r\n\t\t\t\tawait saveImageProfile(token, image)\r\n\t\t\t}\r\n\r\n            const user = await retrieveUser(token)\r\n\r\n            setUser(user)            \r\n\r\n           history.push(\"/profile\")\r\n\r\n        } catch (error) {\r\n            console.error(error)\r\n        }      \r\n    }\r\n\r\n    async function handleToCreateAd( ) {   \r\n\r\n           history.push(\"/newad\")\r\n  \r\n    }\r\n\r\n    async function handleCreateAd(image, title, price, description) {   \r\n\r\n         try {\r\n\r\n            const token = sessionStorage.token \r\n\r\n            const priceN = Number.parseInt(price)\r\n\r\n            const adId = await createAd(token, title, description, priceN)\r\n\r\n            if (image) {\r\n\t\t\t\tawait saveImageAd(token, adId, image)\r\n\t\t\t}\r\n\r\n            const user = await retrieveUser(token)\r\n            const ad = await retrieveAd(adId)\r\n\r\n            setAd(ad)  \r\n            setUser(user)            \r\n\r\n           history.push(`/ad/${adId}`)\r\n\r\n        } catch (error) {\r\n            console.error(error)\r\n        }  \r\n    }\r\n\r\n\r\n    // ESTOY AQUI\r\n\r\n    async function handleToPubliProfile(id) {   \r\n        let token = \"\"\r\n        let user = \"\"\r\n        let ads = []\r\n\r\n        if (!id) {\r\n            token = sessionStorage.token \r\n            user = await retrieveUser(token)\r\n            id = user.id\r\n            ads = await retrieveAds(token)\r\n            console.log(ads)\r\n        } else {\r\n            user = await retrievePublicUser(id)\r\n            id = user.id\r\n            ads = await retrievePublicAds(id)\r\n\r\n        } \r\n\r\n        setAds(ads)   \r\n        setUser(user)\r\n        \r\n        history.push(`/publicprofile/${id}`)\r\n  \r\n    }\r\n\r\n\r\n\r\n\r\n    const { token } = sessionStorage\r\n\r\n    return <>\r\n        {/* <Route exact path=\"/\" render={() => <Header onBack={handleGoBack}/>} /> */}\r\n        <Route exact path=\"/\" render={() => <><Landing onSearch={handleSearch} onLogin={handleGoToLogin} onRegister={handleGoToRegister} onLogout={handleLogout} ads={ads} adDetail={handleAdDetail} onProfile={handleProfile}\r\n                                                       onToCreateAd={handleToCreateAd} onToPubliProfile={handleToPubliProfile}/></>}/> \r\n        <Route path=\"/register\" render={() => <><Header onBack={handleGoBack}/>  <Register onRegister={handleRegister}/></>}/> \r\n        <Route path=\"/login\" render={() => <><Header onBack={handleGoBack}/> <Login onLogin={handleLogin}/></>}/>  \r\n        <Route path=\"/ad/:adId\" render={() => <><Header onBack={handleGoBack}/><Detail ad={ad} /></>}/> \r\n        <Route path=\"/profile\" render={() => <><Header onBack={handleGoBack}/><Profile ads={ads} user={user} adDetail={handleAdDetail} onDeleteAd={handleDeleteAd} onToUpdateAd={handleToUpdateAd} onUpdateUser={handleUpdateUser}/></>}/> \r\n        <Route path=\"/update/:adId\" render={() => <><Header onBack={handleGoBack}/><ModifyAd ad={ad} onUpdateAd={handleOnUpdateAd}/></>}/>\r\n        <Route path=\"/newad\" render={() => <><Header onBack={handleGoBack}/><CreateAd onCreateAd={handleCreateAd}/></>}/>\r\n        <Route path=\"/publicprofile/:id\" render={() => <PublicProfile ads={ads} user={user} adDetail={handleAdDetail}/>}/>\r\n\r\n    </>\r\n})\r\n{/* <Route path=\"/register\" render={() => token ? <Redirect to=\"/board\" /> : <Register onRegister={handleRegister} onBack={handleGoBack} />} />\r\n<Route path=\"/login\" render={() => token ? <Redirect to=\"/board\" /> : <Login onLogin={handleLogin} onBack={handleGoBack} />} />\r\n<Route path=\"/board\" render={() => token ? <Board user={name} tasks={tasks} onLogout={handleLogout} onChangeTaskStatus={handleChangeTaskStatus} onNewTask={handleNewTask} /> : <Redirect to=\"/\" />} />\r\n<Route path=\"/hello/:name\" render={props => <Hello name={props.match.params.name} />} />\r\n<Route path=\"/hello/:name\" render={({ match: { params: { name } } }) => <Hello name={name} />} /> */}"]},"metadata":{},"sourceType":"module"}