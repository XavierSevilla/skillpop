{"ast":null,"code":"const call = require('../../utils/call');\n\nconst _require = require('tasks-util'),\n      validate = _require.validate,\n      CredentialsError = _require.errors.CredentialsError; // const { env: { REACT_APP_API_URL: API_URL } } = process\n\n\nconst API_URL = process.env.REACT_APP_API_URL;\n\nmodule.exports = function (username, password) {\n  validate.string(username);\n  validate.string.notVoid('username', username);\n  validate.string(password);\n  validate.string.notVoid('password', password);\n  return (async () => {\n    const res = await call(`${API_URL}/users/auth`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        username,\n        password\n      })\n    });\n    if (res.status === 200) return JSON.parse(res.body).token;\n    if (res.status === 401) throw new CredentialsError(JSON.parse(res.body).message);\n    throw new Error(JSON.parse(res.body).message);\n  })();\n};","map":{"version":3,"sources":["C:/Users/xavie/bootcamp/collab/skylab-bootcamp-201909/staff/javier-sevilla/skillpop/skillpop-app/src/logic/authenticate-user/index.js"],"names":["call","require","validate","CredentialsError","errors","API_URL","process","env","REACT_APP_API_URL","module","exports","username","password","string","notVoid","res","method","headers","body","JSON","stringify","status","parse","token","message","Error"],"mappings":"AAAA,MAAMA,IAAI,GAAGC,OAAO,CAAC,kBAAD,CAApB;;iBACmDA,OAAO,CAAC,YAAD,C;MAAlDC,Q,YAAAA,Q;MAAoBC,gB,YAAVC,M,CAAUD,gB,EAC5B;;;AACA,MAAME,OAAO,GAAGC,OAAO,CAACC,GAAR,CAAYC,iBAA5B;;AAEAC,MAAM,CAACC,OAAP,GAAiB,UAAUC,QAAV,EAAoBC,QAApB,EAA8B;AAC3CV,EAAAA,QAAQ,CAACW,MAAT,CAAgBF,QAAhB;AACAT,EAAAA,QAAQ,CAACW,MAAT,CAAgBC,OAAhB,CAAwB,UAAxB,EAAoCH,QAApC;AACAT,EAAAA,QAAQ,CAACW,MAAT,CAAgBD,QAAhB;AACAV,EAAAA,QAAQ,CAACW,MAAT,CAAgBC,OAAhB,CAAwB,UAAxB,EAAoCF,QAApC;AAEH,SAAO,CAAC,YAAY;AACb,UAAMG,GAAG,GAAG,MAAMf,IAAI,CAAE,GAAEK,OAAQ,aAAZ,EAA0B;AAC5CW,MAAAA,MAAM,EAAE,MADoC;AAE5CC,MAAAA,OAAO,EAAE;AAAE,wBAAgB;AAAlB,OAFmC;AAG5CC,MAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AAAET,QAAAA,QAAF;AAAYC,QAAAA;AAAZ,OAAf;AAHsC,KAA1B,CAAtB;AAMN,QAAIG,GAAG,CAACM,MAAJ,KAAe,GAAnB,EAAwB,OAAOF,IAAI,CAACG,KAAL,CAAWP,GAAG,CAACG,IAAf,EAAqBK,KAA5B;AAElB,QAAIR,GAAG,CAACM,MAAJ,KAAe,GAAnB,EAAwB,MAAM,IAAIlB,gBAAJ,CAAqBgB,IAAI,CAACG,KAAL,CAAWP,GAAG,CAACG,IAAf,EAAqBM,OAA1C,CAAN;AAExB,UAAM,IAAIC,KAAJ,CAAUN,IAAI,CAACG,KAAL,CAAWP,GAAG,CAACG,IAAf,EAAqBM,OAA/B,CAAN;AACH,GAZG,GAAP;AAaA,CAnBD","sourcesContent":["const call = require('../../utils/call')\r\nconst { validate, errors: { CredentialsError } } = require('tasks-util')\r\n// const { env: { REACT_APP_API_URL: API_URL } } = process\r\nconst API_URL = process.env.REACT_APP_API_URL\r\n\r\nmodule.exports = function (username, password) {\r\n    validate.string(username)\r\n    validate.string.notVoid('username', username)\r\n    validate.string(password)\r\n    validate.string.notVoid('password', password)\r\n\r\n\treturn (async () => {\r\n        const res = await call(`${API_URL}/users/auth`, {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({ username, password })\r\n        })\r\n\r\n\t\tif (res.status === 200) return JSON.parse(res.body).token\r\n        \r\n        if (res.status === 401) throw new CredentialsError(JSON.parse(res.body).message)\r\n\r\n        throw new Error(JSON.parse(res.body).message)\r\n    })()\r\n}"]},"metadata":{},"sourceType":"module"}